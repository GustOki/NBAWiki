<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="NBAWiki - Conhe√ßa todos os times da NBA, suas hist√≥rias, t√≠tulos e encontre seu time para torcer! Agora com chat inteligente powered by Google Gemini.">
    <meta name="theme-color" content="#0a0a0f">

    <meta property="og:title" content="NBAWiki - Guia completo dos times da NBA">
    <meta property="og:description" content="Explore todos os 30 times da NBA, compare estat√≠sticas e encontre seu time para torcer! Chat IA com Google Gemini.">
    <meta property="og:type" content="website">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="gemini-chat.css">

    <title>NBAWiki - Guia dos Times da NBA com IA</title>
</head>

<body>
    <header>
        <div class="header-content">
            <div class="header-top">
                <h1>NBAWIKI</h1>
                <div class="search-box">
                    <input type="text" placeholder="Buscar time..." aria-label="Buscar time">
                    <button id="botao-busca" onclick="iniciarBusca()">Buscar</button>
                </div>
            </div>
        </div>
    </header>

    <main>
        <section class="card-container" aria-label="Lista de times da NBA">
        </section>
    </main>

    <footer class="footer">
        <ul class="footer-links">
            <li>
                <a href="https://github.com/GustOki" target="_blank" rel="noopener">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
                    </svg>
                    GitHub
                </a>
            </li>
            <li>
                <a href="https://www.linkedin.com/in/gustavooki/" target="_blank" rel="noopener">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"/>
                    </svg>
                    LinkedIn
                </a>
            </li>
        </ul>
        <p style="text-align:center; margin-top:1rem; color:var(--text-muted); font-size:0.8rem;">
            Feito por Gustavo Oki - 2025
        </p>
    </footer>

    <button id="gemini-chat-button" class="gemini-chat-button" aria-label="Abrir chat do assistente">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
            <path d="M12 2C6.48 2 2 6.48 2 12c0 1.54.36 3 .97 4.29L2 22l5.71-.97C9 21.64 10.46 22 12 22c5.52 0 10-4.48 10-10S17.52 2 12 2zm0 18c-1.38 0-2.68-.29-3.86-.82l-.28-.13-2.76.47.47-2.76-.13-.28C4.29 14.68 4 13.38 4 12c0-4.41 3.59-8 8-8s8 3.59 8 8-3.59 8-8 8z"/>
            <circle cx="9" cy="12" r="1"/>
            <circle cx="12" cy="12" r="1"/>
            <circle cx="15" cy="12" r="1"/>
        </svg>
        <span class="notification-badge">AI</span>
    </button>

    <div id="gemini-chat-container" class="gemini-chat-container">
        <div class="chat-header">
            <div class="chat-title">
                <span class="ai-icon">ü§ñ</span>
                <span>Assistente NBA</span>
                <span class="powered-by">Powered by Gemini</span>
            </div>
            <button class="chat-minimize" aria-label="Minimizar">‚àí</button>
        </div>

        <div class="chat-messages" id="chat-messages">
            <div class="chat-message assistant">
                <div class="message-content">
                    <p>üëã Ol√°! Sou seu assistente inteligente de NBA! Posso ajudar voc√™ a:</p>
                    <ul>
                        <li>Encontrar times por caracter√≠sticas</li>
                        <li>Comparar estat√≠sticas</li>
                        <li>Recomendar times para torcer</li>
                        <li>Responder curiosidades</li>
                    </ul>
                    <p>Experimente perguntar algo!</p>
                </div>
            </div>

            <div class="suggestions" id="chat-suggestions">
                <div class="suggestions-title">üí° Sugest√µes:</div>
                <button class="suggestion-chip" data-suggestion="üèÜ Quais times t√™m mais de 5 t√≠tulos?">
                    üèÜ Quais times t√™m mais de 5 t√≠tulos?
                </button>
                <button class="suggestion-chip" data-suggestion="üìç Me mostre times da Calif√≥rnia">
                    üìç Me mostre times da Calif√≥rnia
                </button>
                <button class="suggestion-chip" data-suggestion="‚≠ê Sugira um time para come√ßar a torcer">
                    ‚≠ê Sugira um time para come√ßar a torcer
                </button>
                <button class="suggestion-chip" data-suggestion="üìä Compare Lakers e Celtics">
                    üìä Compare Lakers e Celtics
                </button>
                <button class="suggestion-chip" data-suggestion="üéØ Times que nunca ganharam t√≠tulo">
                    üéØ Times que nunca ganharam t√≠tulo
                </button>
                <button class="suggestion-chip" data-suggestion="üíú Times com uniforme roxo">
                    üíú Times com uniforme roxo
                </button>
                <button class="suggestion-chip" data-suggestion="üèÄ Hist√≥ria dos Chicago Bulls">
                    üèÄ Hist√≥ria dos Chicago Bulls
                </button>
            </div>
        </div>

        <div class="chat-input-container">
            <input 
                type="text" 
                id="chat-input" 
                placeholder="Pergunte sobre times da NBA..."
                aria-label="Campo de pergunta"
            />
            <button id="chat-send" aria-label="Enviar">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M22 2L11 13M22 2l-7 20-4-9-9-4 20-7z"/>
                </svg>
            </button>
        </div>
    </div>

    <script src="config.js" onerror="console.warn('‚ö†Ô∏è config.js n√£o encontrado')"></script>
    <script src="script.js"></script>
    <script src="gemini-integration.js"></script>
    
    <!-- Script de inicializa√ß√£o -->
    <script>
        // Fun√ß√£o para carregar dados manualmente (caso script.js n√£o carregue)
        async function garantirDados() {
            if (window.dados && window.dados.length > 0) {
                console.log('‚úÖ Dados j√° carregados:', window.dados.length, 'times');
                return true;
            }
            
            console.log('üìä Carregando dados...');
            
            try {
                const response = await fetch('data.json');
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}`);
                }
                
                window.dados = await response.json();
                
                // Processar dados (mesmo c√≥digo do script.js)
                window.dados.forEach(d => {
                    d.titulos = typeof d.titulos === "number" ? d.titulos : parseInt(d.titulos) || 0;
                });
                
                window.dados.sort((a, b) => a.nome.localeCompare(b.nome, "pt", { sensitivity: "base" }));
                
                console.log('‚úÖ Dados carregados e processados:', window.dados.length, 'times');
                return true;
            } catch (error) {
                console.error('‚ùå Erro ao carregar dados:', error);
                return false;
            }
        }
        
        // Aguardar p√°gina carregar completamente
        window.addEventListener('load', async () => {
            console.log('üîÑ Window load - inicializando aplica√ß√£o');
            
            // 1. Garantir que dados est√£o carregados
            const dadosOk = await garantirDados();
            
            if (!dadosOk) {
                console.error('‚ùå Falha ao carregar dados - aplica√ß√£o n√£o pode iniciar');
                alert('Erro ao carregar dados dos times. Por favor, recarregue a p√°gina.');
                return;
            }
            
            // 2. Verificar se fun√ß√µes do script.js existem e chamar
            if (typeof renderCards === 'function' && window.dados) {
                console.log('üé® Renderizando cards...');
                renderCards(window.dados);
            }
            
            // 3. Inicializar chat Gemini
            if (typeof GEMINI_API_KEY !== 'undefined' && GEMINI_API_KEY) {
                console.log('ü§ñ Inicializando chat Gemini...');
                
                try {
                    const result = initGeminiAssistant(GEMINI_API_KEY);
                    
                    if (result && result.assistant) {
                        // Garantir que o assistente tem os dados
                        result.assistant.loadTeamsData(window.dados);
                        console.log('‚úÖ Chat Gemini inicializado com sucesso!');
                    }
                } catch (error) {
                    console.error('‚ùå Erro ao inicializar chat:', error);
                }
            } else {
                console.warn('‚ö†Ô∏è API Key n√£o encontrada - chat desabilitado');
                const chatButton = document.getElementById('gemini-chat-button');
                if (chatButton) {
                    chatButton.style.display = 'none';
                }
            }
            
            console.log('‚úÖ Aplica√ß√£o inicializada!');
        });
    </script>
</body>
</html>